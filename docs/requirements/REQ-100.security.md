---
id: REQ-100
domain: requirements
status: approved
source_of_truth: false
related: [ARC-004, TECH-001]
acceptance:
  - "Given container starts, then filesystem is read-only."
  - "Given container runs, then all capabilities are dropped except required ones."
  - "Given user input is received, then shell metacharacters are sanitized."
derived_from: [VISION-003]
---

# REQ-100: Security Hardening

## Description

All containers run with security hardening measures to minimize attack surface and prevent privilege escalation.

## Security Measures

### Container Isolation
- `read_only: true`: Filesystem is read-only
- `no-new-privileges: true`: Cannot gain new privileges
- `cap_drop: ALL`: Drop all Linux capabilities
- `cap_add`: Only DAC_OVERRIDE, SETUID, SETGID as needed

### Temporary Storage
- `tmpfs` mounts for /tmp and /run
- Size-limited to prevent resource exhaustion

### Input Sanitization
- DEVICE_NAME environment variable stripped of shell metacharacters
- Prevents command injection via service names

### File Permissions
- FIFO pipes: 660 (owner+group only)
- Config files: read-only mounts

### Network
- Host networking required but services bind to specific ports
- No exposed management ports beyond required APIs

## Exceptions

- `apparmor:unconfined`: Required for D-Bus access to Avahi
- User namespace not used (requires host UID/GID mapping)
