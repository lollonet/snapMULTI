---
id: REQ-001
domain: requirements
status: approved
source_of_truth: false
related: [ARC-001, TECH-001]
acceptance:
  - "Given MPD container is running, when user adds music to /music, then MPD database updates automatically."
  - "Given MPD is playing, when audio is written to FIFO, then snapserver receives audio stream."
  - "Given myMPD is accessible, when user browses library, then album art and metadata display correctly."
derived_from: [VISION-002]
---

# REQ-001: MPD Local Music Playback

## Description

Music Player Daemon (MPD) provides local music library playback. It reads audio files from a mounted directory, maintains a searchable database, and outputs audio to a FIFO pipe consumed by Snapcast.

## Behavior

1. MPD scans `/music` directory on startup and when files change (`auto_update: yes`)
2. Audio output goes to `/audio/snapcast_fifo` in 44100:16:2 format
3. HTTP stream available on port 8000 for direct access
4. Control interface on port 6600 (MPD protocol)
5. myMPD web UI on port 8180 for browser-based control

## Configuration

- `config/mpd.conf`: MPD settings
- `MUSIC_PATH`: Environment variable for music directory mount
- `MPD_START_PERIOD`: Healthcheck grace period (30s local, 300s NFS)

## Dependencies

- Snapserver must be healthy before MPD starts writing to FIFO
- Music directory must be accessible (local or NFS mount)
