---
id: REQ-010
domain: requirements
status: approved
source_of_truth: false
related: [ARC-002, TECH-001]
acceptance:
  - "Given snapserver is running, when client connects, then audio plays in sync with other clients."
  - "Given multiple sources are configured, when source is selected, then correct audio stream plays."
  - "Given client is muted, then no audio data is sent to that client (send_to_muted: false)."
derived_from: [VISION-001, VISION-002]
---

# REQ-010: Snapcast Synchronized Playback

## Description

Snapserver is the core component that receives audio from multiple sources and distributes it to connected clients with precise time synchronization.

## Behavior

1. Receives audio from FIFO pipes (MPD, Spotify, AirPlay, Tidal)
2. Encodes to FLAC and distributes to clients
4. Maintains <10ms sync across all clients
5. Snapweb UI + JSON-RPC API on port 1780
6. TCP streaming on port 1704
7. TCP control on port 1705

## Configuration

- `config/snapserver.conf`: All source and streaming settings
- `buffer: 2400`: Buffer size in milliseconds
- `chunk_ms: 40`: Chunk size for streaming
- `codec: flac`: Audio codec

## Streams

| Stream | Source | Port/Path |
|--------|--------|-----------|
| MPD | FIFO | /audio/snapcast_fifo |
| Spotify | FIFO | /audio/spotify_fifo |
| AirPlay | FIFO | /audio/airplay_fifo |
| Tidal | FIFO | /audio/tidal_fifo |

## Dependencies

- Audio FIFOs must exist in /audio directory
- Host networking for mDNS discovery
