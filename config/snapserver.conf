# Snapserver configuration
# Multiroom audio server
# Adjust max_clients based on your needs (0 = unlimited)

[server]
datadir = /data/

# mDNS/Bonjour service publishing
# Use container hostname for service name (set via docker-compose hostname:)
mdns_enabled = true

[http]
enabled = true
bind_to_address = 0.0.0.0
port = 1780
# doc_root = /usr/share/snapweb  # Not installed - web UI disabled

# Hostname announced via mDNS (clients connect using this name)
# Uses container hostname set in docker-compose.yml
host = snapmulti

# Enable mDNS publishing for HTTP API
publish_http = false
publish_https = false

[tcp-control]
enabled = true
bind_to_address = 0.0.0.0
port = 1705

# Enable mDNS publishing for TCP control
publish = true

[tcp-streaming]
enabled = true
bind_to_address = 0.0.0.0
port = 1704
publish = true

# Stream configuration - Multiple audio sources
# Clients can choose which stream to play via Snapcast client/app

[stream]
# Source 1: MPD (local music library)
# controlscript fetches now-playing metadata (title, artist, cover art) from MPD
source = pipe:////audio/snapcast_fifo?name=MPD&controlscript=meta_mpd.py

# Source 2: Tidal Connect - Cast from Tidal app (ARM only, Pi 3/4/5)
# Open Tidal app → Select device → "<hostname> Tidal"
# Reads from tidal-connect container via named pipe (ALSA file plugin)
source = pipe:////audio/tidal_fifo?name=Tidal

# Source 3: AirPlay - Apple devices (iPhone, iPad, Mac)
# Connect from iOS: Control Center → AirPlay → Select "snapMULTI"
# Reads from shairport-sync container via named pipe
# controlscript reads metadata from shairport-sync metadata pipe
source = pipe:////audio/airplay_fifo?name=AirPlay&controlscript=meta_shairport.py

# Source 4: Spotify Connect - Stream from Spotify app (requires Premium)
# Open Spotify → Connect to a device → Select "<hostname> Spotify"
# Reads from go-librespot container via named pipe
# controlscript fetches metadata (title, artist, cover art) and enables playback control
source = pipe:////audio/spotify_fifo?name=Spotify&controlscript=meta_go-librespot.py

# --- Available sources (uncomment to enable) ---
# See docs/SOURCES.md for full parameter reference

# Source 6: ALSA capture (line-in, mic, loopback)
# Requires: devices: [/dev/snd:/dev/snd] in docker-compose.yml
#source = alsa:///?name=LineIn&device=hw:0,0

# Source 7: Meta stream (auto-switch between sources)
# Plays highest-priority active source (left = highest)
#source = meta:///MPD/Spotify/AirPlay?name=AutoSwitch

# Source 8: File playback (alerts, TTS, doorbell)
# File must be raw PCM matching sampleformat (44100:16:2)
#source = file:///audio/alert.pcm?name=Alert

# Source 9: TCP client (pull from remote audio source)
#source = tcp://192.168.1.100:4953?name=Remote&mode=client

# Common settings for all sources
sampleformat = 44100:16:2
codec = flac
buffer = 2400
chunk_ms = 40
send_to_muted = false
max_clients = 0

[streaming_client]
initial_volume = 100

[logging]
sink = stdout
filter = *:error
