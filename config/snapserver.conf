# Snapserver configuration
# Multiroom audio server
# Adjust max_clients based on your needs (0 = unlimited)

[server]
datadir = /data/

# mDNS/Bonjour service publishing
mdns_enabled = true

[http]
enabled = true
bind_to_address = 0.0.0.0
port = 1780
# doc_root = /usr/share/snapweb  # Not installed - web UI disabled

# Enable mDNS publishing for HTTP API
publish_http = true
publish_https = false

[tcp-control]
enabled = true
bind_to_address = 0.0.0.0
port = 1705

# Enable mDNS publishing for TCP control
publish = true

[tcp-streaming]
enabled = true
bind_to_address = 0.0.0.0
port = 1704
publish = true

# Stream configuration - Multiple audio sources
# Clients can choose which stream to play via Snapcast client/app

[stream]
# Source 1: MPD (local music library)
source = pipe:////audio/snapcast_fifo?name=MPD

# Source 2: TCP input - Any app can stream to port 4953
# Example: ffmpeg -i http://stream.example.com -f s16le -ar 48000 -ac 2 tcp://raspy:4953
source = tcp://0.0.0.0:4953?name=TCP-Input&mode=server

# Source 3: AirPlay - Apple devices (iPhone, iPad, Mac)
# Connect from iOS: Control Center → AirPlay → Select "Snapcast"
source = airplay:///usr/bin/shairport-sync?name=AirPlay&devicename=snapMULTI

# Common settings for all sources
sampleformat = 48000:16:2
codec = flac
buffer = 1000
send_to_muted = false
max_clients = 0

# Note: To switch to AirPlay:
# 1. Edit this file: replace the [stream] section above with:
#    source = airplay:///usr/bin/shairport-sync?name=AirPlay&devicename=snapMULTI
#    sampleformat = 44100:16:2
#    codec = flac
# 2. Restart: docker compose restart snapMULTI
# 3. Connect your iPhone/iPad to "Snapcast" AirPlay
# 4. Play music from your Apple device
#
# To switch back to MPD, reverse the change.

[streaming_client]
initial_volume = 100

[logging]
sink = stdout
filter = *:info
